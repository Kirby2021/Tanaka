{"version":3,"sources":["Structures/Client.js"],"names":["CommandoClient","require","Intents","WebhookClient","FeedEmitter","TimerManager","execSync","Manager","Turndown","BotList","consola","Redis","web","Keyv","module","exports","[object Object]","super","commandPrefix","process","env","COMMAND_PREFIX","owner","OWNER_ID","intents","NON_PRIVILEGED","FLAGS","GUILDS","partials","this","db","DATABASE_URL","logger","create","level","rss","testWebhook","TEST_WEBHOOK_ID","TEST_WEBHOOK_TOKEN","redis","timers","converter","bl","client","manager","send","id","payload","guild","guilds","cache","get","shard","ip","timeout","encoding","token","DISCORD_TOKEN","addRSSListeners","login","url","refresh","eventName","ignoreFirst","forEach","feed","add","registry","groups","map","g","commands","filter","c","hidden","name","extra","ownerOnly","nsfw","description","join"],"mappings":"AAAA,MAAMA,eAAEA,gBAAmBC,QAAQ,wBAC7BC,QAAEA,QAAOC,cAAEA,eAAkBF,QAAQ,eACrCG,YAAEA,aAAgBH,QAAQ,kBAC1BI,aAAeJ,QAAQ,mBACvBK,SAAEA,UAAaL,QAAQ,kBACvBM,QAAEA,SAAYN,QAAQ,YACtBO,SAAWP,QAAQ,YACnBQ,QAAUR,QAAQ,aAClBS,QAAUT,QAAQ,WAClBU,MAAQV,QAAQ,WAChBW,IAAMX,QAAQ,UACdY,KAAOZ,QAAQ,QAErBa,OAAOC,QAAU,cAAqBf,eACrCgB,cACCC,MAAM,CACLC,cAAeC,QAAQC,IAAIC,eAC3BC,MAAOH,QAAQC,IAAIG,SACnBC,QAAS,CAACtB,QAAQuB,eAAgBvB,QAAQwB,MAAMC,QAChDC,SAAU,CAAC,aAGZC,KAAKC,GAAK,IAAIjB,KAAKM,QAAQC,IAAIW,cAE/BF,KAAKG,OAAStB,QAAQuB,OAAO,CAC5BC,MAAO,IAGRL,KAAKM,IAAM,IAAI/B,YAEfyB,KAAKO,YAAc,IAAIjC,cAAcgB,QAAQC,IAAIiB,gBAAiBlB,QAAQC,IAAIkB,oBAE9ET,KAAKU,MAAQ,IAAI5B,MAAMkB,MAAMC,GAE7BD,KAAKW,OAAS,IAAInC,aAAawB,MAE/BA,KAAKY,UAAY,IAAIjC,SAErBqB,KAAKa,GAAK,IAAIjC,QAAQoB,MAEtBA,KAAKc,OAASd,KAEdA,KAAKe,QAAU,IAAIrC,QAAQ,CAC1BsC,KAAM,CAACC,EAAIC,KACV,MAAMC,EAAQnB,KAAKoB,OAAOC,MAAMC,IAAIL,GAEhCE,GAAOA,EAAMI,MAAMP,KAAKE,MAK/BM,SAEC,OADW/C,SAAS,gCAAiC,CAAEgD,QAAS,IAAOC,SAAU,UAIlFvC,YAAYwC,EAAQrC,QAAQC,IAAIqC,eAI/B,OAHA5B,KAAK6B,kBACL9C,IAAIiB,MAEGZ,MAAM0C,MAAMH,GAGpBxC,kBACe,CACb,CACC4C,IAAK,8DACLC,QAAS,IACTC,UAAW,QACXC,aAAa,IAITC,SAASC,GAASpC,KAAKM,IAAI+B,IAAID,KAGtCjD,sBAeC,OAdaa,KAAKsC,SAASC,OACzBC,KAAKC,IACL,MAAMC,EAAWD,EAAEC,SAASC,QAAQC,IAAOA,EAAEC,SAC7C,MAAO,SAASJ,EAAEK,qBAAqBJ,EACrCF,KAAKI,IACL,MAAMG,EAAQ,GAAGH,EAAEI,UAAY,gBAAkB,KAChDJ,EAAEK,KAAO,UAAY,KAEtB,MAAO,gBAAgBL,EAAEE,kBAAkBF,EAAEM,cAAcH,YAE3DI,KAAK,gBAEPA,KAAK","file":"Client.js","sourcesContent":["const { CommandoClient } = require('discord.js-commando');\nconst { Intents, WebhookClient } = require('discord.js');\nconst { FeedEmitter } = require('rss-emitter-ts');\nconst TimerManager = require('./TimerManager');\nconst { execSync } = require('child_process');\nconst { Manager } = require('erela.js');\nconst Turndown = require('turndown');\nconst BotList = require('./BotList');\nconst consola = require('consola');\nconst Redis = require('./Redis');\nconst web = require('../Web');\nconst Keyv = require('keyv');\n\nmodule.exports = class Client extends CommandoClient {\n\tconstructor() {\n\t\tsuper({\n\t\t\tcommandPrefix: process.env.COMMAND_PREFIX,\n\t\t\towner: process.env.OWNER_ID,\n\t\t\tintents: [Intents.NON_PRIVILEGED, Intents.FLAGS.GUILDS],\n\t\t\tpartials: ['CHANNEL'],\n\t\t});\n\n\t\tthis.db = new Keyv(process.env.DATABASE_URL);\n\n\t\tthis.logger = consola.create({\n\t\t\tlevel: 5,\n\t\t});\n\n\t\tthis.rss = new FeedEmitter();\n\n\t\tthis.testWebhook = new WebhookClient(process.env.TEST_WEBHOOK_ID, process.env.TEST_WEBHOOK_TOKEN);\n\n\t\tthis.redis = new Redis(this).db;\n\n\t\tthis.timers = new TimerManager(this);\n\n\t\tthis.converter = new Turndown();\n\n\t\tthis.bl = new BotList(this);\n\n\t\tthis.client = this;\n\n\t\tthis.manager = new Manager({\n\t\t\tsend: (id, payload) => {\n\t\t\t\tconst guild = this.guilds.cache.get(id);\n\n\t\t\t\tif (guild) guild.shard.send(payload);\n\t\t\t},\n\t\t});\n\t}\n\n\tget ip() {\n\t\tconst ip = execSync('curl https://ipecho.net/plain', { timeout: 30000, encoding: 'utf-8' });\n\t\treturn ip;\n\t}\n\n\tasync login(token = process.env.DISCORD_TOKEN) {\n\t\tthis.addRSSListeners();\n\t\tweb(this);\n\n\t\treturn super.login(token);\n\t}\n\n\taddRSSListeners() {\n\t\tconst feeds = [\n\t\t\t{\n\t\t\t\turl: 'https://www.animenewsnetwork.com/all/rss.xml?ann-edition=us',\n\t\t\t\trefresh: 20000,\n\t\t\t\teventName: 'anime',\n\t\t\t\tignoreFirst: true,\n\t\t\t},\n\t\t];\n\n\t\tfeeds.forEach((feed) => this.rss.add(feed));\n\t}\n\n\tgenerateCommandList() {\n\t\tconst list = this.registry.groups\n\t\t\t.map((g) => {\n\t\t\t\tconst commands = g.commands.filter((c) => !c.hidden);\n\t\t\t\treturn `\\n<h3>${g.name}:</h3>\\n\\n<ul>${commands\n\t\t\t\t\t.map((c) => {\n\t\t\t\t\t\tconst extra = `${c.ownerOnly ? ' (Owner-Only)' : ''}${\n\t\t\t\t\t\t\tc.nsfw ? ' (NSFW)' : ''\n\t\t\t\t\t\t}`;\n\t\t\t\t\t\treturn `<li> <strong>${c.name}:</strong> ${c.description}${extra}</li>`;\n\t\t\t\t\t})\n\t\t\t\t\t.join('</ul>\\n')}`;\n\t\t\t})\n\t\t\t.join('\\n');\n\n\t\treturn list;\n\t}\n};\n"]}