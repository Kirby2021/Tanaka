const{CommandoClient:CommandoClient}=require("discord.js-commando"),{Intents:Intents,WebhookClient:WebhookClient}=require("discord.js"),{FeedEmitter:FeedEmitter}=require("rss-emitter-ts"),TimerManager=require("./TimerManager"),request=require("node-superfetch"),{Manager:Manager}=require("erela.js"),Turndown=require("turndown"),BotList=require("./BotList"),consola=require("consola"),Redis=require("./Redis"),web=require("../Web"),Keyv=require("keyv");module.exports=class extends CommandoClient{constructor(){super({commandPrefix:process.env.COMMAND_PREFIX,owner:process.env.OWNER_ID,intents:[Intents.NON_PRIVILEGED,Intents.FLAGS.GUILDS],partials:["CHANNEL"]}),this.db=new Keyv(process.env.DATABASE_URL),this.logger=consola.create({level:5}),this.rss=new FeedEmitter,this.testWebhook=new WebhookClient(process.env.TEST_WEBHOOK_ID,process.env.TEST_WEBHOOK_TOKEN),this.redis=new Redis(this).db,this.timers=new TimerManager(this),this.converter=new Turndown,this.bl=new BotList(this),this.client=this,this.manager=new Manager({send:(e,n)=>{const r=this.guilds.cache.get(e);r&&r.shard.send(n)}})}async ip(){const{text:e}=await request.get("https://api.ipify.org/");return e}async login(e=process.env.DISCORD_TOKEN){return this.addRSSListeners(),web(this),super.login(e)}addRSSListeners(){[{url:"https://www.animenewsnetwork.com/all/rss.xml?ann-edition=us",refresh:2e4,eventName:"anime",ignoreFirst:!0}].forEach((e=>this.rss.add(e)))}generateCommandList(){return this.registry.groups.map((e=>{const n=e.commands.filter((e=>!e.hidden));return`\n<h3>${e.name}:</h3>\n\n<ul>${n.map((e=>{const n=`${e.ownerOnly?" (Owner-Only)":""}${e.nsfw?" (NSFW)":""}`;return`<li> <strong>${e.name}:</strong> ${e.description}${n}</li>`})).join("</ul>\n")}`})).join("\n")}};
//# sourceMappingURL=Client.js.map
