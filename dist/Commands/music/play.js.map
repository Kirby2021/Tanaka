{"version":3,"sources":["Commands/music/play.js"],"names":["Command","require","MessageEmbed","module","exports","[object Object]","client","super","name","aliases","group","memberName","description","guildOnly","args","key","prompt","type","msg","title","channel","member","voice","reply","player","this","manager","create","guild","id","voiceChannel","textChannel","res","state","connect","search","author","loadType","queue","current","destroy","exception","err","message","add","tracks","track","playing","paused","size","play","embed","setTitle","setURL","uri","setImage","thumbnail","setAuthor","setColor","setFooter","requester","tag","setTimestamp","totalSize","length","playlist","collected","max","filter","m","test","content","results","slice","map","index","join","say","awaitMessages","time","errors","e","first","toLowerCase","Number"],"mappings":"AAAA,MAAMA,QAAEA,SAAYC,QAAQ,wBACtBC,aAAEA,cAAiBD,QAAQ,cAEjCE,OAAOC,QAAU,cAA0BJ,QAC1CK,YAAYC,GACXC,MAAMD,EAAQ,CACbE,KAAM,OACNC,QAAS,CAAC,aAAc,KACxBC,MAAO,QACPC,WAAY,OACZC,YAAa,kCACbC,WAAW,EACXC,KAAM,CACL,CACCC,IAAK,QACLC,OAAQ,kCACRC,KAAM,aAMVZ,UAAUa,GAAKC,MAAEA,IAChB,MAAMC,QAAEA,GAAYF,EAAIG,OAAOC,MAE/B,IAAKF,EAAS,OAAOF,EAAIK,MAAM,qCAE/B,MAAMC,EAASC,KAAKnB,OAAOoB,QAAQC,OAAO,CACzCC,MAAOV,EAAIU,MAAMC,GACjBC,aAAcV,EAAQS,GACtBE,YAAab,EAAIE,QAAQS,KAK1B,IAAIG,EAFiB,cAAjBR,EAAOS,OAAuBT,EAAOU,UAIzC,IAGC,GAFAF,QAAYR,EAAOW,OAAOhB,EAAOD,EAAIkB,QAEhB,gBAAjBJ,EAAIK,SAGP,MAFKb,EAAOc,MAAMC,SAASf,EAAOgB,UAE5BR,EAAIS,UAEV,MAAOC,GACR,OAAOxB,EAAIK,MAAM,uCAAuCmB,EAAIC,YAG7D,OAAQX,EAAIK,UACX,IAAK,aAGJ,OAFKb,EAAOc,MAAMC,SAASf,EAAOgB,UAE3BtB,EAAIK,MAAM,gCAClB,IAAK,eAAgB,CACpBC,EAAOc,MAAMM,IAAIZ,EAAIa,OAAO,IAE5B,MAAMC,EAAQd,EAAIa,OAAO,GAEpBrB,EAAOuB,SAAYvB,EAAOwB,QAAWxB,EAAOc,MAAMW,MAAMzB,EAAO0B,OAEpE,MAAMC,GAAQ,IAAIjD,cAChBkD,SAAS,wBAAwBN,EAAM3B,aACvCkC,OAAOP,EAAMQ,KACbC,SAAST,EAAMU,WAAa,IAC5BC,UAAUX,EAAMV,QAChBsB,SAAS,UACTC,UAAU,iBAAiBb,EAAMc,UAAUC,OAC3CC,eAEF,OAAO5C,EAAIK,MAAM4B,GAElB,IAAK,kBAMJ,OALA3B,EAAOc,MAAMM,IAAIZ,EAAIa,QAEhBrB,EAAOuB,SAAYvB,EAAOwB,QAAUxB,EAAOc,MAAMyB,YAAc/B,EAAIa,OAAOmB,QAC9ExC,EAAO0B,OAEDhC,EAAIK,MACV,sBAAsBS,EAAIiC,SAASzD,eAAewB,EAAIa,OAAOmB,kBAE/D,IAAK,gBAAiB,CACrB,IACIE,EADAC,EAAM,EAEV,MAAMC,EAAUC,GAAMA,EAAEjC,OAAOP,KAAOX,EAAIkB,OAAOP,IAAM,eAAeyC,KAAKD,EAAEE,SAEzEvC,EAAIa,OAAOmB,OAASG,IAAKA,EAAMnC,EAAIa,OAAOmB,QAE9C,MAAMQ,EAAU,yBAAyBxC,EAAIa,OAC3C4B,MAAM,EAAGN,GACTO,KAAI,CAAC5B,EAAO6B,IAAU,KAAKA,SAAa7B,EAAM3B,YAC9CyD,KAAK,QAEP1D,EAAI2D,IAAIL,GAER,IACCN,QAAkBhD,EAAIE,QAAQ0D,cAAcV,EAAQ,CACnDD,IAAK,EACLY,KAAM,IACNC,OAAQ,CAAC,UAET,MAAOC,GAGR,OAFKzD,EAAOc,MAAMC,SAASf,EAAOgB,UAE3BtB,EAAIK,MAAM,mCAGlB,MAAM2D,EAAQhB,EAAUgB,QAAQX,QAEhC,GAA4B,QAAxBW,EAAMC,cAGT,OAFK3D,EAAOc,MAAMC,SAASf,EAAOgB,UAE3BtB,EAAI2D,IAAI,wBAGhB,MAAMF,EAAQS,OAAOF,GAAS,EAE9B,GAAIP,EAAQ,GAAKA,EAAQR,EAAM,EAC9B,OAAOjD,EAAI2D,IAAI,sDAAsDV,OAEtE,MAAMrB,EAAQd,EAAIa,OAAO8B,GACzBnD,EAAOc,MAAMM,IAAIE,GAEZtB,EAAOuB,SAAYvB,EAAOwB,QAAWxB,EAAOc,MAAMW,MAAMzB,EAAO0B,OAEpE,MAAMC,GAAQ,IAAIjD,cAChBkD,SAAS,wBAAwBN,EAAM3B,aACvCkC,OAAOP,EAAMQ,KACbC,SAAST,EAAMU,WAAa,IAC5BC,UAAUX,EAAMV,QAChBsB,SAAS,UACTC,UAAU,iBAAiBb,EAAMc,UAAUC,OAC3CC,eAEF,OAAO5C,EAAIK,MAAM4B","file":"play.js","sourcesContent":["const { Command } = require('discord.js-commando');\nconst { MessageEmbed } = require('discord.js');\n\nmodule.exports = class PlayCommand extends Command {\n\tconstructor(client) {\n\t\tsuper(client, {\n\t\t\tname: 'play',\n\t\t\taliases: ['play-music', 'p'],\n\t\t\tgroup: 'music',\n\t\t\tmemberName: 'play',\n\t\t\tdescription: \"Add's music to the music queue.\",\n\t\t\tguildOnly: true,\n\t\t\targs: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'title',\n\t\t\t\t\tprompt: 'What is the title of the music?',\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t}\n\n\tasync run(msg, { title }) {\n\t\tconst { channel } = msg.member.voice;\n\n\t\tif (!channel) return msg.reply('You need to join a voice channel!');\n\n\t\tconst player = this.client.manager.create({\n\t\t\tguild: msg.guild.id,\n\t\t\tvoiceChannel: channel.id,\n\t\t\ttextChannel: msg.channel.id,\n\t\t});\n\n\t\tif (player.state !== 'CONNECTED') player.connect();\n\n\t\tlet res;\n\n\t\ttry {\n\t\t\tres = await player.search(title, msg.author);\n\n\t\t\tif (res.loadType === 'LOAD_FAILED') {\n\t\t\t\tif (!player.queue.current) player.destroy();\n\n\t\t\t\tthrow res.exception;\n\t\t\t}\n\t\t} catch (err) {\n\t\t\treturn msg.reply(`There was an error while searching: ${err.message}.`);\n\t\t}\n\n\t\tswitch (res.loadType) {\n\t\t\tcase 'NO_MATCHES':\n\t\t\t\tif (!player.queue.current) player.destroy();\n\n\t\t\t\treturn msg.reply('There were no results found.');\n\t\t\tcase 'TRACK_LOADED': {\n\t\t\t\tplayer.queue.add(res.tracks[0]);\n\n\t\t\t\tconst track = res.tracks[0];\n\n\t\t\t\tif (!player.playing && !player.paused && !player.queue.size) player.play();\n\n\t\t\t\tconst embed = new MessageEmbed()\n\t\t\t\t\t.setTitle(`**Adding to queue: __${track.title}__**`)\n\t\t\t\t\t.setURL(track.uri)\n\t\t\t\t\t.setImage(track.thumbnail || '')\n\t\t\t\t\t.setAuthor(track.author)\n\t\t\t\t\t.setColor('RANDOM')\n\t\t\t\t\t.setFooter(`Requested by: ${track.requester.tag}`)\n\t\t\t\t\t.setTimestamp();\n\n\t\t\t\treturn msg.reply(embed);\n\t\t\t}\n\t\t\tcase 'PLAYLIST_LOADED':\n\t\t\t\tplayer.queue.add(res.tracks);\n\n\t\t\t\tif (!player.playing && !player.paused && player.queue.totalSize === res.tracks.length)\n\t\t\t\t\tplayer.play();\n\n\t\t\t\treturn msg.reply(\n\t\t\t\t\t`Queuing playlist \\`${res.playlist.name}\\` with ${res.tracks.length} tracks.`,\n\t\t\t\t);\n\t\t\tcase 'SEARCH_RESULT': {\n\t\t\t\tlet max = 5;\n\t\t\t\tlet collected;\n\t\t\t\tconst filter = (m) => m.author.id === msg.author.id && /^(\\d+|end)$/i.test(m.content);\n\n\t\t\t\tif (res.tracks.length < max) max = res.tracks.length;\n\n\t\t\t\tconst results = `Reply with a number.\\n${res.tracks\n\t\t\t\t\t.slice(0, max)\n\t\t\t\t\t.map((track, index) => `${++index} - \\`${track.title}\\``)\n\t\t\t\t\t.join('\\n')}`;\n\n\t\t\t\tmsg.say(results);\n\n\t\t\t\ttry {\n\t\t\t\t\tcollected = await msg.channel.awaitMessages(filter, {\n\t\t\t\t\t\tmax: 1,\n\t\t\t\t\t\ttime: 30e3,\n\t\t\t\t\t\terrors: ['time'],\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (!player.queue.current) player.destroy();\n\n\t\t\t\t\treturn msg.reply(\"You didn't provide a selection.\");\n\t\t\t\t}\n\n\t\t\t\tconst first = collected.first().content;\n\n\t\t\t\tif (first.toLowerCase() === 'end') {\n\t\t\t\t\tif (!player.queue.current) player.destroy();\n\n\t\t\t\t\treturn msg.say('Cancelled selection.');\n\t\t\t\t}\n\n\t\t\t\tconst index = Number(first) - 1;\n\n\t\t\t\tif (index < 0 || index > max - 1)\n\t\t\t\t\treturn msg.say(`The number you provided is too small or too big (1-${max}).`);\n\n\t\t\t\tconst track = res.tracks[index];\n\t\t\t\tplayer.queue.add(track);\n\n\t\t\t\tif (!player.playing && !player.paused && !player.queue.size) player.play();\n\n\t\t\t\tconst embed = new MessageEmbed()\n\t\t\t\t\t.setTitle(`**Adding to queue: __${track.title}__**`)\n\t\t\t\t\t.setURL(track.uri)\n\t\t\t\t\t.setImage(track.thumbnail || '')\n\t\t\t\t\t.setAuthor(track.author)\n\t\t\t\t\t.setColor('RANDOM')\n\t\t\t\t\t.setFooter(`Requested by: ${track.requester.tag}`)\n\t\t\t\t\t.setTimestamp();\n\n\t\t\t\treturn msg.reply(embed);\n\t\t\t}\n\t\t}\n\t}\n};\n"]}