const{streamToArray:streamToArray}=require("../../Structures/Util"),{createCanvas:createCanvas,loadImage:loadImage}=require("canvas"),{Command:Command}=require("discord.js-commando"),request=require("node-superfetch"),GIFEncoder=require("gifencoder"),path=require("path");module.exports=class extends Command{constructor(e){super(e,{name:"triggered",group:"img",memberName:"triggered",description:"Applies the triggered effect to an image.",throttling:{usages:1,duration:10},clientPermissions:["ATTACH_FILES"],args:[{key:"image",prompt:"What image would you like to edit?",type:"image",default:e=>e.author.displayAvatarURL({format:"png",size:512})}]})}async run(e,{image:a}){try{const{body:r}=await request.get(a),t=await loadImage(path.join(__dirname,"..","..","Assets","image","triggered.png")),o=await loadImage(r),i=new GIFEncoder(256,310),s=i.createReadStream();i.start(),i.setRepeat(0),i.setDelay(15);const n=createCanvas(256,310).getContext("2d"),m=30,d=20;let g=0;for(;g<9;)n.clearRect(0,0,256,310),n.drawImage(o,Math.floor(Math.random()*m)-m,Math.floor(Math.random()*m)-m,256+m,256+m),n.fillStyle="##FF000033",n.fillRect(0,0,256,310),n.drawImage(t,Math.floor(Math.random()*d)-d,256+Math.floor(Math.random()*d)-d,256+d,54+d),i.addFrame(n),g++;i.finish();const c=await streamToArray(s);return e.say({files:[{attachment:Buffer.concat(c),name:"triggered.gif"}]})}catch(a){return e.reply(`An error occured: \`${a.message}\`.`)}}};
//# sourceMappingURL=triggered.js.map
