const{drawImageWithTint:drawImageWithTint}=require("../../Structures/Canvas"),{streamToArray:streamToArray}=require("../../Structures/Util"),{createCanvas:createCanvas,loadImage:loadImage}=require("canvas"),{Command:Command}=require("discord.js-commando"),request=require("node-superfetch"),GIFEncoder=require("gifencoder"),path=require("path"),coord1=[-25,-33,-42,-14],coord2=[-25,-13,-34,-10];module.exports=class extends Command{constructor(e){super(e,{name:"triggered",group:"img",memberName:"triggered",description:"Applies the triggered effect to an image.",throttling:{usages:1,duration:30},clientPermissions:["ATTACH_FILES"],args:[{key:"image",prompt:"What image would you like to edit?",type:"image",default:e=>e.author.displayAvatarURL({format:"png",size:512})}]})}async run(e,{image:t}){try{const r=await loadImage(path.join(__dirname,"..","..","Assets","image","triggered.png")),{body:a}=await request.get(t),i=await loadImage(a),o=new GIFEncoder(r.width,r.width),d=createCanvas(r.width,r.width).getContext("2d");d.fillStyle="white",d.fillRect(0,0,r.width,r.width);const s=o.createReadStream();o.start(),o.setRepeat(0),o.setDelay(50),o.setQuality(200);for(let e=0;e<4;e++)drawImageWithTint(d,i,"red",coord1[e],coord2[e],300,300),d.drawImage(r,0,218,256,38),o.addFrame(d);o.finish();const n=await streamToArray(s);return e.say({files:[{attachment:Buffer.concat(n),name:"triggered.gif"}]})}catch(t){return e.reply(`An error occured: \`${t.message}\`.`)}}};
//# sourceMappingURL=triggered.js.map
