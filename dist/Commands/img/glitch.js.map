{"version":3,"sources":["Commands/img/glitch.js"],"names":["distort","require","createCanvas","loadImage","Command","request","module","exports","[object Object]","client","super","name","group","memberName","description","throttling","usages","duration","clientPermissions","args","key","prompt","type","default","msg","author","displayAvatarURL","format","size","image","body","get","data","canvas","width","height","ctx","getContext","drawImage","attachment","toBuffer","Buffer","byteLength","reply","say","files","err","message"],"mappings":"AAAA,MAAMA,QAAEA,SAAYC,QAAQ,4BACtBC,aAAEA,aAAYC,UAAEA,WAAcF,QAAQ,WACtCG,QAAEA,SAAYH,QAAQ,uBACtBI,QAAUJ,QAAQ,mBAExBK,OAAOC,QAAU,cAA4BH,QAC5CI,YAAYC,GACXC,MAAMD,EAAQ,CACbE,KAAM,SACNC,MAAO,MACPC,WAAY,SACZC,YAAa,yCACbC,WAAY,CACXC,OAAQ,EACRC,SAAU,IAEXC,kBAAmB,CAAC,gBACpBC,KAAM,CACL,CACCC,IAAK,QACLC,OAAQ,qCACRC,KAAM,QACNC,QAAUC,GAAQA,EAAIC,OAAOC,iBAAiB,CAAEC,OAAQ,MAAOC,KAAM,WAMzEpB,UAAUgB,GAAKK,MAAEA,IAChB,IACC,MAAMC,KAAEA,SAAezB,QAAQ0B,IAAIF,GAC7BG,QAAa7B,UAAU2B,GACvBG,EAAS/B,aAAa8B,EAAKE,MAAOF,EAAKG,QACvCC,EAAMH,EAAOI,WAAW,MAE9BD,EAAIE,UAAUN,EAAM,EAAG,GACvBhC,QAAQoC,EAAK,GAAI,EAAG,EAAGJ,EAAKE,MAAOF,EAAKG,OAAQ,GAEhD,MAAMI,EAAaN,EAAOO,WAE1B,OAAIC,OAAOC,WAAWH,GAAc,IAAYf,EAAImB,MAAM,mCAEnDnB,EAAIoB,IAAI,CAAEC,MAAO,CAAC,CAAEN,WAAAA,EAAY5B,KAAM,iBAC5C,MAAOmC,GACR,OAAOtB,EAAImB,MAAM,uBAAuBG,EAAIC","file":"glitch.js","sourcesContent":["const { distort } = require('../../Structures/Canvas');\nconst { createCanvas, loadImage } = require('canvas');\nconst { Command } = require('discord.js-commando');\nconst request = require('node-superfetch');\n\nmodule.exports = class GlitchCommand extends Command {\n\tconstructor(client) {\n\t\tsuper(client, {\n\t\t\tname: 'glitch',\n\t\t\tgroup: 'img',\n\t\t\tmemberName: 'glitch',\n\t\t\tdescription: 'Applies the glitch effect to an image.',\n\t\t\tthrottling: {\n\t\t\t\tusages: 1,\n\t\t\t\tduration: 10,\n\t\t\t},\n\t\t\tclientPermissions: ['ATTACH_FILES'],\n\t\t\targs: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'image',\n\t\t\t\t\tprompt: 'What image would you like to edit?',\n\t\t\t\t\ttype: 'image',\n\t\t\t\t\tdefault: (msg) => msg.author.displayAvatarURL({ format: 'png', size: 4096 }),\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t}\n\n\tasync run(msg, { image }) {\n\t\ttry {\n\t\t\tconst { body } = await request.get(image);\n\t\t\tconst data = await loadImage(body);\n\t\t\tconst canvas = createCanvas(data.width, data.height);\n\t\t\tconst ctx = canvas.getContext('2d');\n\n\t\t\tctx.drawImage(data, 0, 0);\n\t\t\tdistort(ctx, 20, 0, 0, data.width, data.height, 5);\n\n\t\t\tconst attachment = canvas.toBuffer();\n\n\t\t\tif (Buffer.byteLength(attachment) > 8e6) return msg.reply('Resulting image was above 8 MB.');\n\n\t\t\treturn msg.say({ files: [{ attachment, name: 'glitch.png' }] });\n\t\t} catch (err) {\n\t\t\treturn msg.reply(`An error occured: \\`${err.message}\\`.`);\n\t\t}\n\t}\n};\n"]}