const{distort:distort}=require("../../Structures/Canvas"),{createCanvas:createCanvas,loadImage:loadImage}=require("canvas"),{Command:Command}=require("discord.js-commando"),request=require("node-superfetch");module.exports=class extends Command{constructor(e){super(e,{name:"glitch",group:"img",memberName:"glitch",description:"Applies the glitch effect to an image.",throttling:{usages:1,duration:10},clientPermissions:["ATTACH_FILES"],args:[{key:"image",prompt:"What image would you like to edit?",type:"image",default:e=>e.author.displayAvatarURL({format:"png",size:4096})}]})}async run(e,{image:t}){try{const{body:a}=await request.get(t),r=await loadImage(a),s=createCanvas(r.width,r.height),i=s.getContext("2d");i.drawImage(r,0,0),distort(i,20,0,0,r.width,r.height,5);const o=s.toBuffer();return Buffer.byteLength(o)>8e6?e.reply("Resulting image was above 8 MB."):e.say({files:[{attachment:o,name:"glitch.png"}]})}catch(t){return e.reply(`An error occured: \`${t.message}\`.`)}}};
//# sourceMappingURL=glitch.js.map
