{"version":3,"sources":["Commands/search/npm.js"],"names":["toPercent","formatBytes","require","Command","MessageEmbed","request","moment","module","exports","NPMCommand","[object Object]","client","super","name","aliases","group","memberName","description","clientPermissions","args","key","prompt","type","parse","q","encodeURIComponent","throttling","usages","duration","msg","query","message","embed","body","get","size","set","User-Agent","total","edit","dat","results","maintainers","dependencies","devDependencies","data","collected","metadata","score","npm","source","depsMap","devDepsMap","deps","Object","keys","push","devDeps","forEach","p","username","setAuthor","setTitle","setURL","links","setDescription","addField","version","author","license","date","format","dependentsCount","files","readmeSize","detail","quality","popularity","maintenance","join","setFooter","keywords","setColor","setTimestamp"],"mappings":"AAAA,MAAMA,UAAEA,UAASC,YAAEA,aAAgBC,QAAQ,0BACrCC,QAAEA,SAAYD,QAAQ,wBACtBE,aAAEA,cAAiBF,QAAQ,cAC3BG,QAAUH,QAAQ,mBAClBI,OAASJ,QAAQ,UAEvBK,OAAOC,QAAU,MAAMC,mBAAmBN,QACzCO,YAAYC,GACXC,MAAMD,EAAQ,CACbE,KAAM,MACNC,QAAS,CAAC,cACVC,MAAO,SACPC,WAAY,MACZC,YAAa,iCACbC,kBAAmB,CAAC,eACpBC,KAAM,CACL,CACCC,IAAK,QACLC,OAAQ,sBACRC,KAAM,SACNC,MAAQC,GAAMC,mBAAmBD,KAGnCE,WAAY,CACXC,OAAQ,EACRC,SAAU,MAKblB,UAAUmB,GAAKC,MAAEA,IAChB,MAAMC,QAAgBF,EAAIG,MAAM,CAAEf,YAAa,kBAEzCgB,KAAEA,SAAe5B,QACrB6B,IAAI,iCACJJ,MAAM,CAAEN,EAAGM,EAAOK,KAAM,IACxBC,IAAI,CAAEC,aAAc,2DAEtB,GAAmB,IAAfJ,EAAKK,MAAa,OAAOP,EAAQQ,KAAK,CAAEP,MAAO,CAAEf,YAAa,iCAElE,MAAQgB,KAAMO,SAAcnC,QAC1B6B,IAAI,kCAAkCD,EAAKQ,QAAQ,GAAG5B,QACtDuB,IAAI,CAAEC,aAAc,2DAEhBK,EAAc,GACdC,EAAe,GACfC,EAAkB,GAClBC,EAAOL,EAAIM,UAAUC,UACrBC,MAAEA,EAAKC,IAAEA,EAAGC,OAAEA,GAAWV,EAEzBW,EAAUN,EAAKF,cAAgB,KAC/BS,EAAaP,EAAKD,iBAAmB,KAE3C,GAAgB,OAAZO,EAAkB,IAAK,MAAME,KAAQC,OAAOC,KAAKJ,GAAUR,EAAaa,KAAKH,GACjF,GAAmB,OAAfD,EAAqB,IAAK,MAAMK,KAAWH,OAAOC,KAAKH,GAAaR,EAAgBY,KAAKC,GAE7FZ,EAAKH,YAAYgB,SAASC,GAAMjB,EAAYc,KAAKG,EAAEC,YAEnD,MAAM5B,GAAQ,IAAI5B,cAChByD,UACA,MACA,+EACA,qBAEAC,SAASjB,EAAKhC,MACdkD,OAAOlB,EAAKmB,MAAMf,KAClBgB,eAAepB,EAAK5B,aACpBiD,SAAS,YAAarB,EAAKsB,SAAS,GACpCD,SAAS,WAAYrB,EAAKuB,OAASvB,EAAKuB,OAAOvD,KAAO,WAAW,GACjEqD,SAAS,YAAarB,EAAKwB,SAAW,QAAQ,GAC9CH,SAAS,sBAAuB5D,OAAOuC,EAAKyB,MAAMC,OAAO,4BAA4B,GACrFL,SAAS,eAAgBjB,EAAIuB,iBAAiB,GAC9CN,SAAS,gBAAiBjE,YAAYiD,EAAOuB,MAAMC,aAAa,GAChER,SAAS,YAAalE,UAAUgD,EAAM2B,OAAOC,UAAU,GACvDV,SAAS,eAAgBlE,UAAUgD,EAAM2B,OAAOE,aAAa,GAC7DX,SAAS,gBAAiBlE,UAAUgD,EAAM2B,OAAOG,cAAc,GAC/DZ,SAAS,gBAAiBxB,EAAYqC,KAAK,OAC3Cb,SAAS,iBAAkBvB,EAAaoC,KAAK,OAAS,QACtDb,SAAS,qBAAsBtB,EAAgBmC,KAAK,OAAS,QAC7DC,UAAUnC,EAAKoC,SAASF,KAAK,MAAO,IACpCG,SAAS,WACTC,eAEF,OAAOpD,EAAQQ,KAAKP","file":"npm.js","sourcesContent":["const { toPercent, formatBytes } = require('../../Structures/Util');\nconst { Command } = require('discord.js-commando');\nconst { MessageEmbed } = require('discord.js');\nconst request = require('node-superfetch');\nconst moment = require('moment');\n\nmodule.exports = class NPMCommand extends Command {\n\tconstructor(client) {\n\t\tsuper(client, {\n\t\t\tname: 'npm',\n\t\t\taliases: ['npm-search'],\n\t\t\tgroup: 'search',\n\t\t\tmemberName: 'npm',\n\t\t\tdescription: 'Searches NPMJS for your query.',\n\t\t\tclientPermissions: ['EMBED_LINKS'],\n\t\t\targs: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'query',\n\t\t\t\t\tprompt: 'What is your query?',\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tparse: (q) => encodeURIComponent(q),\n\t\t\t\t},\n\t\t\t],\n\t\t\tthrottling: {\n\t\t\t\tusages: 5,\n\t\t\t\tduration: 15,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync run(msg, { query }) {\n\t\tconst message = await msg.embed({ description: 'Fetching....' });\n\n\t\tconst { body } = await request\n\t\t\t.get(`https://api.npms.io/v2/search`)\n\t\t\t.query({ q: query, size: 1 })\n\t\t\t.set({ 'User-Agent': 'TanakaBot 1.0.0 (https://github.com/1chiSensei/Tanaka)' });\n\n\t\tif (body.total === 0) return message.edit({ embed: { description: 'Could not find any results.' } });\n\n\t\tconst { body: dat } = await request\n\t\t\t.get(`https://api.npms.io/v2/package/${body.results[0].name}`)\n\t\t\t.set({ 'User-Agent': 'TanakaBot 1.0.0 (https://github.com/1chiSensei/Tanaka)' });\n\n\t\tconst maintainers = [];\n\t\tconst dependencies = [];\n\t\tconst devDependencies = [];\n\t\tconst data = dat.collected.metadata;\n\t\tconst { score, npm, source } = dat;\n\n\t\tconst depsMap = data.dependencies ?? null;\n\t\tconst devDepsMap = data.devDependencies ?? null;\n\n\t\tif (depsMap !== null) for (const deps of Object.keys(depsMap)) dependencies.push(deps);\n\t\tif (devDepsMap !== null) for (const devDeps of Object.keys(devDepsMap)) devDependencies.push(devDeps);\n\n\t\tdata.maintainers.forEach((p) => maintainers.push(p.username));\n\n\t\tconst embed = new MessageEmbed()\n\t\t\t.setAuthor(\n\t\t\t\t'NPM',\n\t\t\t\t'https://github.com/PKief/vscode-material-icon-theme/raw/master/icons/npm.svg',\n\t\t\t\t'https://npmjs.com',\n\t\t\t)\n\t\t\t.setTitle(data.name)\n\t\t\t.setURL(data.links.npm)\n\t\t\t.setDescription(data.description)\n\t\t\t.addField('❯ Version', data.version, true)\n\t\t\t.addField('❯ Author', data.author ? data.author.name : 'Unknown', true)\n\t\t\t.addField('❯ License', data.license ?? 'None', true)\n\t\t\t.addField('❯ Modification Date', moment(data.date).format('MMMM Do YYYY, h:mm:ss a'), true)\n\t\t\t.addField('❯ Dependents', npm.dependentsCount, true)\n\t\t\t.addField('❯ README Size', formatBytes(source.files.readmeSize), true)\n\t\t\t.addField('❯ Quality', toPercent(score.detail.quality), true)\n\t\t\t.addField('❯ Popularity', toPercent(score.detail.popularity), true)\n\t\t\t.addField('❯ Maintenance', toPercent(score.detail.maintenance), true)\n\t\t\t.addField('❯ Maintainers', maintainers.join(', '))\n\t\t\t.addField('❯ Dependencies', dependencies.join(', ') ?? 'None')\n\t\t\t.addField('❯ Dev Dependencies', devDependencies.join(', ') ?? 'None')\n\t\t\t.setFooter(data.keywords.join('\\n'), '')\n\t\t\t.setColor('#cb3837')\n\t\t\t.setTimestamp();\n\n\t\treturn message.edit(embed);\n\t}\n};\n"]}