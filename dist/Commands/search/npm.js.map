{"version":3,"sources":["Commands/search/npm.js"],"names":["toPercent","formatBytes","require","Command","MessageEmbed","request","moment","module","exports","NPMCommand","[object Object]","client","super","name","aliases","group","memberName","description","clientPermissions","args","key","prompt","type","parse","q","encodeURIComponent","throttling","usages","duration","msg","query","message","embed","body","get","size","set","User-Agent","total","edit","dat","results","maintainers","dependencies","devDependencies","data","collected","metadata","source","npm","depsMap","devDepsMap","deps","Object","keys","push","devDeps","forEach","p","username","setAuthor","setTitle","setURL","links","setDescription","addField","version","author","license","date","format","dependentsCount","files","readmeSize","score","detail","quality","popularity","maintenance","join","setFooter","keywords","setColor","setTimestamp"],"mappings":"AAAA,MAAMA,UAAEA,UAASC,YAAEA,aAAgBC,QAAQ,0BACrCC,QAAEA,SAAYD,QAAQ,wBACtBE,aAAEA,cAAiBF,QAAQ,cAC3BG,QAAUH,QAAQ,mBAClBI,OAASJ,QAAQ,UAEvBK,OAAOC,QAAU,MAAMC,mBAAmBN,QACzCO,YAAYC,GACXC,MAAMD,EAAQ,CACbE,KAAM,MACNC,QAAS,CAAC,cACVC,MAAO,SACPC,WAAY,MACZC,YAAa,iCACbC,kBAAmB,CAAC,eACpBC,KAAM,CACL,CACCC,IAAK,QACLC,OAAQ,sBACRC,KAAM,SACNC,MAAQC,GAAMC,mBAAmBD,KAGnCE,WAAY,CACXC,OAAQ,EACRC,SAAU,MAKblB,UAAUmB,GAAKC,MAAEA,IAChB,MAAMC,QAAgBF,EAAIG,MAAM,CAAEf,YAAa,kBAEzCgB,KAAEA,SAAe5B,QACrB6B,IAAI,iCACJJ,MAAM,CAAEN,EAAGM,EAAOK,KAAM,IACxBC,IAAI,CAAEC,aAAc,2DAEtB,GAAmB,IAAfJ,EAAKK,MAAa,OAAOP,EAAQQ,KAAK,CAAEP,MAAO,CAAEf,YAAa,iCAElE,MAAQgB,KAAMO,SAAcnC,QAC1B6B,IAAI,kCAAkCD,EAAKQ,QAAQ,GAAG5B,QACtDuB,IAAI,CAAEC,aAAc,2DAEhBK,EAAc,GACdC,EAAe,GACfC,EAAkB,GAClBC,EAAOL,EAAIM,UAAUC,UACrBC,OAAEA,EAAMC,IAAEA,GAAQT,EAAIM,UAEtBI,EAAUL,EAAKF,cAAgB,KAC/BQ,EAAaN,EAAKD,iBAAmB,KAE3C,GAAgB,OAAZM,EAAkB,IAAK,MAAME,KAAQC,OAAOC,KAAKJ,GAAUP,EAAaY,KAAKH,GACjF,GAAmB,OAAfD,EAAqB,IAAK,MAAMK,KAAWH,OAAOC,KAAKH,GAAaP,EAAgBW,KAAKC,GAE7FX,EAAKH,YAAYe,SAASC,GAAMhB,EAAYa,KAAKG,EAAEC,YAEnD,MAAM3B,GAAQ,IAAI5B,cAChBwD,UACA,MACA,+EACA,qBAEAC,SAAShB,EAAKhC,MACdiD,OAAOjB,EAAKkB,MAAMd,KAClBe,eAAenB,EAAK5B,aACpBgD,SAAS,YAAapB,EAAKqB,SAAW,WAAW,GACjDD,SAAS,WAAYpB,EAAKsB,OAAStB,EAAKsB,OAAOtD,KAAO,WAAW,GACjEoD,SAAS,YAAapB,EAAKuB,SAAW,QAAQ,GAC9CH,SACA,sBACA3D,OAAOuC,EAAKwB,MAAMC,OAAO,4BAA8B,WACvD,GAEAL,SAAS,eAAgBhB,EAAIsB,iBAAmB,KAAK,GACrDN,SAAS,gBAAiBhE,YAAY+C,EAAOwB,MAAMC,aAAe,aAAa,GAC/ER,SAAS,YAAajE,UAAUwC,EAAIkC,MAAMC,OAAOC,UAAY,WAAW,GACxEX,SAAS,eAAgBjE,UAAUwC,EAAIkC,MAAMC,OAAOE,aAAe,WAAW,GAC9EZ,SAAS,gBAAiBjE,UAAUwC,EAAIkC,MAAMC,OAAOG,cAAgB,WAAW,GAChFb,SAAS,gBAAiBvB,EAAYqC,KAAK,OAAS,QACpDd,SAAS,iBAAkBtB,EAAaoC,KAAK,OAAS,QACtDd,SAAS,qBAAsBrB,EAAgBmC,KAAK,OAAS,QAC7DC,UAAUnC,EAAKoC,SAASF,KAAK,OAAS,eACtCG,SAAS,WACTC,eAEF,OAAOpD,EAAQQ,KAAKP","file":"npm.js","sourcesContent":["const { toPercent, formatBytes } = require('../../Structures/Util');\nconst { Command } = require('discord.js-commando');\nconst { MessageEmbed } = require('discord.js');\nconst request = require('node-superfetch');\nconst moment = require('moment');\n\nmodule.exports = class NPMCommand extends Command {\n\tconstructor(client) {\n\t\tsuper(client, {\n\t\t\tname: 'npm',\n\t\t\taliases: ['npm-search'],\n\t\t\tgroup: 'search',\n\t\t\tmemberName: 'npm',\n\t\t\tdescription: 'Searches NPMJS for your query.',\n\t\t\tclientPermissions: ['EMBED_LINKS'],\n\t\t\targs: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'query',\n\t\t\t\t\tprompt: 'What is your query?',\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tparse: (q) => encodeURIComponent(q),\n\t\t\t\t},\n\t\t\t],\n\t\t\tthrottling: {\n\t\t\t\tusages: 5,\n\t\t\t\tduration: 15,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync run(msg, { query }) {\n\t\tconst message = await msg.embed({ description: 'Fetching....' });\n\n\t\tconst { body } = await request\n\t\t\t.get(`https://api.npms.io/v2/search`)\n\t\t\t.query({ q: query, size: 1 })\n\t\t\t.set({ 'User-Agent': 'TanakaBot 1.0.0 (https://github.com/1chiSensei/Tanaka)' });\n\n\t\tif (body.total === 0) return message.edit({ embed: { description: 'Could not find any results.' } });\n\n\t\tconst { body: dat } = await request\n\t\t\t.get(`https://api.npms.io/v2/package/${body.results[0].name}`)\n\t\t\t.set({ 'User-Agent': 'TanakaBot 1.0.0 (https://github.com/1chiSensei/Tanaka)' });\n\n\t\tconst maintainers = [];\n\t\tconst dependencies = [];\n\t\tconst devDependencies = [];\n\t\tconst data = dat.collected.metadata;\n\t\tconst { source, npm } = dat.collected;\n\n\t\tconst depsMap = data.dependencies || null;\n\t\tconst devDepsMap = data.devDependencies || null;\n\n\t\tif (depsMap !== null) for (const deps of Object.keys(depsMap)) dependencies.push(deps);\n\t\tif (devDepsMap !== null) for (const devDeps of Object.keys(devDepsMap)) devDependencies.push(devDeps);\n\n\t\tdata.maintainers.forEach((p) => maintainers.push(p.username));\n\n\t\tconst embed = new MessageEmbed()\n\t\t\t.setAuthor(\n\t\t\t\t'NPM',\n\t\t\t\t'https://github.com/PKief/vscode-material-icon-theme/raw/master/icons/npm.svg',\n\t\t\t\t'https://npmjs.com',\n\t\t\t)\n\t\t\t.setTitle(data.name)\n\t\t\t.setURL(data.links.npm)\n\t\t\t.setDescription(data.description)\n\t\t\t.addField('❯ Version', data.version || 'Unknown', true)\n\t\t\t.addField('❯ Author', data.author ? data.author.name : 'Unknown', true)\n\t\t\t.addField('❯ License', data.license || 'None', true)\n\t\t\t.addField(\n\t\t\t\t'❯ Modification Date',\n\t\t\t\tmoment(data.date).format('MMMM Do YYYY, h:mm:ss a') || 'Unknown',\n\t\t\t\ttrue,\n\t\t\t)\n\t\t\t.addField('❯ Dependents', npm.dependentsCount || '0', true)\n\t\t\t.addField('❯ README Size', formatBytes(source.files.readmeSize) || 'No README', true)\n\t\t\t.addField('❯ Quality', toPercent(dat.score.detail.quality) || 'Unknown', true)\n\t\t\t.addField('❯ Popularity', toPercent(dat.score.detail.popularity) || 'Unknown', true)\n\t\t\t.addField('❯ Maintenance', toPercent(dat.score.detail.maintenance) || 'Unknown', true)\n\t\t\t.addField('❯ Maintainers', maintainers.join(', ') || 'None')\n\t\t\t.addField('❯ Dependencies', dependencies.join(', ') || 'None')\n\t\t\t.addField('❯ Dev Dependencies', devDependencies.join(', ') || 'None')\n\t\t\t.setFooter(data.keywords.join('\\n') || 'No Keywords')\n\t\t\t.setColor('#cb3837')\n\t\t\t.setTimestamp();\n\n\t\treturn message.edit(embed);\n\t}\n};\n"]}