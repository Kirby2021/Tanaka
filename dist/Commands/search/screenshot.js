const{screenshot:screenshot}=require("../../Structures/Puppeteer"),{isUrl:isUrl}=require("../../Structures/Util"),{Command:Command}=require("discord.js-commando"),request=require("node-superfetch"),url=require("url");module.exports=class extends Command{constructor(t){super(t,{name:"screenshot",aliases:["ss"],memberName:"screenshot",group:"search",description:"Screenshots a website.",throttling:{usages:2,duration:60},args:[{key:"link",prompt:"What is the link of the website?",type:"string",validate:t=>isUrl(t)}]}),this.nsfwList=null}async run(t,{link:s}){try{await t.channel.startTyping(),this.nsfwList||await this.fetchNSFWList();const e=url.parse(s);if(this.nsfwList.some((t=>e.host===t))&&!t.channel.nsfw)return t.reply("This site is NSFW. Please try again in a NSFW channel.");const n=await screenshot(s);return t.say({files:[{attachment:n,name:"screenshot.png"}]}),t.channel.stopTyping()}catch{return t.reply("Couldn't find any results. Invalid URL?"),t.channel.stopTyping()}}async fetchNSFWList(t=!1){if(!t&&this.nsfwList)return this.nsfwList;const{text:s}=await request.get("https://blocklistproject.github.io/Lists/alt-version/porn-nl.txt");return this.nsfwList=s.split("\n").filter((t=>t&&!t.startsWith("#"))).map((t=>t.replace(/^(0.0.0.0)/,""))),this.nsfwList}};
//# sourceMappingURL=screenshot.js.map
