{"version":3,"sources":["Events/rss/new-item.js"],"names":["WebhookClient","MessageEmbed","require","Event","htmlToText","module","exports","[object Object]","args","super","emitter","item","this","client","guilds","cache","forEach","async","guild","available","fetch","data","db","get","id","hook","token","embed","setTitle","title","setAuthor","author","setDescription","description","setURL","link","setColor","setImage","image","setTimestamp","send"],"mappings":"AAAA,MAAMA,cAAEA,cAAaC,aAAEA,cAAiBC,QAAQ,cAC1CC,MAAQD,QAAQ,2BAChBE,WAAEA,YAAeF,QAAQ,gBAE/BG,OAAOC,QAAU,cAA8BH,MAC9CI,eAAeC,GACdC,SAASD,EAAM,iBAAkB,CAAEE,QAAS,QAI7CH,IAAII,GACHC,KAAKC,OAAOC,OAAOC,MAAMC,SAAQC,MAAOC,IAClCA,EAAMC,YAAWD,QAAcA,EAAME,SAC1C,MAAMC,QAAaT,KAAKC,OAAOS,GAAGC,IAAI,gBAAgBL,EAAMM,MAE5D,IAAKH,EAAM,OAEX,MAAMI,EAAO,IAAIzB,cAAcqB,EAAKG,GAAIH,EAAKK,OACvCC,GAAQ,IAAI1B,cAChB2B,SAAS,KAAKjB,EAAKkB,WACnBC,UAAUnB,EAAKoB,QACfC,eAAe5B,WAAWO,EAAKsB,cAC/BC,OAAOvB,EAAKwB,MACZC,SAAS,UACTC,SAAS1B,EAAK2B,OAAS,mCACvBC,eAEFd,EAAKe,KAAKb","file":"new-item.js","sourcesContent":["const { WebhookClient, MessageEmbed } = require('discord.js');\nconst Event = require('../../Structures/Event');\nconst { htmlToText } = require('html-to-text');\n\nmodule.exports = class RSSNewItemEvent extends Event {\n\tconstructor(...args) {\n\t\tsuper(...args, 'item:new:anime', { emitter: 'rss' });\n\t}\n\n\t/** @param {import('rss-emitter-ts').FeedItem} item */\n\trun(item) {\n\t\tthis.client.guilds.cache.forEach(async (guild) => {\n\t\t\tif (!guild.available) guild = await guild.fetch();\n\t\t\tconst data = await this.client.db.get(`animeUpdates-${guild.id}`);\n\n\t\t\tif (!data) return;\n\n\t\t\tconst hook = new WebhookClient(data.id, data.token);\n\t\t\tconst embed = new MessageEmbed()\n\t\t\t\t.setTitle(`**${item.title}**`)\n\t\t\t\t.setAuthor(item.author)\n\t\t\t\t.setDescription(htmlToText(item.description))\n\t\t\t\t.setURL(item.link)\n\t\t\t\t.setColor('RANDOM')\n\t\t\t\t.setImage(item.image || 'https://i.imgur.com/R3JCtNK.jpg')\n\t\t\t\t.setTimestamp();\n\n\t\t\thook.send(embed);\n\t\t});\n\t}\n};\n"]}