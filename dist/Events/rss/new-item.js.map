{"version":3,"sources":["Events/rss/new-item.js"],"names":["Event","require","module","exports","[object Object]","args","super","emitter","item","this","client","shard","broadcastEval","title","author","description","link","image"],"mappings":"AAAA,MAAMA,MAAQC,QAAQ,0BAEtBC,OAAOC,QAAU,cAA8BH,MAC9CI,eAAeC,GACdC,SAASD,EAAM,iBAAkB,CAAEE,QAAS,QAI7CH,IAAII,GACHC,KAAKC,OAAOC,MAAMC,cAAc,4dAYbJ,EAAKK,oCACRL,EAAKM,iDACWN,EAAKO,oCACxBP,EAAKQ,6DAEHR,EAAKS","file":"new-item.js","sourcesContent":["const Event = require('../../Structures/Event');\n\nmodule.exports = class RSSNewItemEvent extends Event {\n\tconstructor(...args) {\n\t\tsuper(...args, 'item:new:anime', { emitter: 'rss' });\n\t}\n\n\t/** @param {import('rss-emitter-ts').FeedItem} item */\n\trun(item) {\n\t\tthis.client.shard.broadcastEval(`\n\t\t\tconst { WebhookClient, MessageEmbed } = require('discord.js');\n\t\t\tconst { htmlToText } = require('html-to-text');\n\n\t\t\tthis.guilds.cache.forEach(async (guild) => {\n\t\t\t\tif (!guild.available) guild = await guild.fetch();\n\t\t\t\tconst data = await this.db.get(\\`animeUpdates-\\${guild.id}\\`);\n\n\t\t\t\tif (!data) return;\n\n\t\t\t\tconst hook = new WebhookClient(data.id, data.token);\n\t\t\t\tconst embed = new MessageEmbed()\n\t\t\t\t\t.setTitle(\\`**${item.title}**\\`)\n\t\t\t\t\t.setAuthor(${item.author})\n\t\t\t\t\t.setDescription(htmlToText(${item.description}))\n\t\t\t\t\t.setURL(${item.link})\n\t\t\t\t\t.setColor('RANDOM')\n\t\t\t\t\t.setImage(${item.image} || 'https://i.imgur.com/R3JCtNK.jpg')\n\t\t\t\t\t.setTimestamp();\n\n\t\t\t\thook.send(embed);\n\t\t\t});\n\t\t`);\n\t}\n};\n"]}